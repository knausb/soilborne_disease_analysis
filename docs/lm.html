<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>The Linear Model</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Soilborne Disease Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="background.html">Background</a>
</li>
<li>
  <a href="lm.html">The Linear Model</a>
</li>
<li>
  <a href="exp_design.html">Experimental Design</a>
</li>
<li>
  <a href="sampling_strategy.html">Sampling Strategy</a>
</li>
<li>
  <a href="exercises.html">Excercises</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<p>
<center>
<h3>Soilborne Disease Data Collection and Analysis</h3>
by
<br>
Lindsey Thiessen and Brian J. Knaus
</center>
</p>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">The Linear Model</h1>

</div>


<p>The linear model is the foundation of statistical hypothesis testing. Many of the analyses we encounter in the technical literature can be seen as extensions of the linear model. Understanding experimental design requires an understanding of what test we plan to perform. A foundation in the linear model will help us understand the design and implementation of our experiments.</p>
<div id="the-linear-equation" class="section level2">
<h2>The linear equation</h2>
<p>In grade school geometry we learned the equation of a line.</p>
<p><span class="math display">\[
y = mx + b
\]</span></p>
<p>Here, <code>x</code> and <code>y</code> are coordinates on the plane. The slope is <code>m</code>. And the y-intercept is <code>b</code>. We can plot this in R as follows.</p>
<pre class="r"><code>x &lt;- 1:20
y &lt;- 0.5 * x + 2
plot(x, y)</code></pre>
<div class="figure" style="text-align: center">
<img src="lm_files/figure-html/unnamed-chunk-1-1.png" alt="Figure 1. A straight line." width="672" />
<p class="caption">
Figure 1. A straight line.
</p>
</div>
<p>The first line generates some data and assigns it to the variable <code>x</code>. The second line uses a contrived slope (0.5) and intercept (2) to generate values which we assign to the variable <code>y</code>. Because the values of <code>y</code> <strong>depend</strong> on <code>x</code> we sometimes call <code>y</code> the <strong>dependent</strong> variable and <code>x</code> the <strong>independent</strong> variable. Similarly, we may refer to <code>y</code> as the <strong>response</strong> and <code>x</code> as <strong>predictor(s)</strong>. The line crosses the y-intercept at one and for each increase of value in <code>x</code> we see a half increase in <code>y</code>.</p>
</div>
<div id="adding-the-error-term" class="section level2">
<h2>Adding the error term</h2>
<p>In biology we rarely see such clear patterns. In order to accomodate this variation we add an error term.</p>
<p><span class="math display">\[
y = mx + b + \epsilon_{Norm}
\]</span></p>
<p>This can be plotted in R as follows.</p>
<pre class="r"><code>set.seed(9)
y &lt;- 0.5 * x + 2 + rnorm(n=length(x), mean = 0, sd = 1)
plot(x, y)</code></pre>
<div class="figure" style="text-align: center">
<img src="lm_files/figure-html/unnamed-chunk-2-1.png" alt="Figure 2. A straight line with random error." width="672" />
<p class="caption">
Figure 2. A straight line with random error.
</p>
</div>
<p>This is the exact same plot as in Figure 1 except that the data are now distributed around the line with normally distributed error. The mean of this distribution was zero because we do not want it to deviate from the line. The standard deviation, or the dispersal around the line, was arbitrarily set to one. In your experiments the standard deviation will represent biological variation combined with technical error assotiated with measuring the data.</p>
<div id="linear-regression" class="section level3">
<h3>Linear regression</h3>
<p>When we use linear regression we are attempting to infer the slope and intercept that we’ve specified above. We can use the function <code>lm()</code> to perform the regression and it’s <code>summary()</code> method to report the results.</p>
<pre class="r"><code>lm1 &lt;- lm(y ~ x)
summary(lm1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.4636 -0.5682 -0.1028  0.3166  1.9994 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.84546    0.46805   3.943 0.000954 ***
## x            0.50003    0.03907  12.797 1.78e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.008 on 18 degrees of freedom
## Multiple R-squared:  0.901,  Adjusted R-squared:  0.8955 
## F-statistic: 163.8 on 1 and 18 DF,  p-value: 1.779e-10</code></pre>
<p>In order to perform the linear regression we’ve used the function <code>lm()</code> and saved it’s results in the object <code>lm1</code>. We summarized the object we created with the generic function <code>summary()</code>. We see that the intercept is <code>1.8454587</code>, which should be close to two, and the slope is <code>0.5000256</code>, which should be close to 0.5.</p>
</div>
</div>
<div id="analysis-of-variance" class="section level2">
<h2>Analysis of variance</h2>
<p>In the analysis of soilborne pathogens we are typically looking for differences among groups. In linear regression we were looking for relationships among a (putatively) dependent variable and independent variables. When we investigate soilborne pathogens we’re typically looking for differences among groups of plots. For example, we may be looking for differences among plots that were fumigated, or fertilized, or ammended in some other manner. These are frequently analysis of variance (ANOVA) type questions. ANOVA can be seen as a form of the lineaar model where instead of trying to infer a slope and intercept we’re trying to infer the elevation, or y-intercept, for two or more groups.</p>
<pre class="r"><code>set.seed(99)
my_data &lt;- cbind( rep(c(&#39;A&#39;, &#39;B&#39;, &#39;C&#39;), each = 10), rnorm(n = 30, mean = 10, sd = 2) )
my_data &lt;- as.data.frame(my_data)
colnames(my_data) &lt;- c(&quot;Group&quot;, &quot;Value&quot;)
my_data$Group &lt;- as.factor(my_data$Group)
my_data$Value &lt;- as.numeric(my_data$Value)</code></pre>
<pre class="r"><code>library(ggplot2)
p &lt;- ggplot(data = my_data, mapping = aes(x = Group, y = Value))
p &lt;- p + geom_boxplot()
p &lt;- p + geom_jitter(shape=16, position=position_jitter(0.2))
p &lt;- p + theme_bw()
p</code></pre>
<div class="figure" style="text-align: center">
<img src="lm_files/figure-html/unnamed-chunk-5-1.png" alt="Figure 3. Box and whisker plot of simulated data with normal error." width="672" />
<p class="caption">
Figure 3. Box and whisker plot of simulated data with normal error.
</p>
</div>
<p>Here we’ve simulated three groups of data. We’ve visualized this data using box and whisker plots. I like to add the dots as long as there aren’t too many. And I prefer <code>theme_bw()</code> over the default theme. You may want to omit these steps if you like.</p>
<p>Note that we’ve created a <strong>factor</strong> to indicate which group each sample belongs to. Note that a <strong>factor</strong> is different from a <strong>vector of characters</strong> because a factor includes information about the groups or levels and a vector of characters does not.</p>
<pre class="r"><code>my_data$Group</code></pre>
<pre><code>##  [1] A A A A A A A A A A B B B B B B B B B B C C C C C C C C C C
## Levels: A B C</code></pre>
<pre class="r"><code>as.character(my_data$Group)</code></pre>
<pre><code>##  [1] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot;
## [20] &quot;B&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot;</code></pre>
<p>We can now test for differences in group means.</p>
<pre class="r"><code>options(contrasts = c(&quot;contr.helmert&quot;, &quot;contr.poly&quot;))
lm2 &lt;- lm(Value ~ Group, data = my_data)
summary(lm2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Value ~ Group, data = my_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.200  -6.225  -1.500   8.275  14.700 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   15.500      1.624   9.546 3.81e-10 ***
## Group1         0.950      1.989   0.478    0.637    
## Group2         1.250      1.148   1.089    0.286    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.894 on 27 degrees of freedom
## Multiple R-squared:  0.04974,    Adjusted R-squared:  -0.02065 
## F-statistic: 0.7067 on 2 and 27 DF,  p-value: 0.5022</code></pre>
<pre class="r"><code># http://www.sthda.com/english/wiki/one-way-anova-test-in-r
library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>group_by(my_data, Group) %&gt;%
  summarise(
    count = n(),
    mean = mean(Value, na.rm = TRUE),
    sd = sd(Value, na.rm = TRUE)
  )</code></pre>
<pre><code>## # A tibble: 3 x 4
##   Group count  mean    sd
##   &lt;fct&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A        10  13.3 10.4 
## 2 B        10  15.2  7.87
## 3 C        10  18    8.15</code></pre>
<pre class="r"><code>mean(my_data$Value)</code></pre>
<pre><code>## [1] 15.5</code></pre>
<p>Shapiro-Wilk test of normality</p>
<p>Levene’s test for common variance</p>
<div id="contrasts" class="section level3">
<h3>Contrasts</h3>
<pre class="r"><code>options(&quot;contrasts&quot;)</code></pre>
<pre><code>## $contrasts
## [1] &quot;contr.helmert&quot; &quot;contr.poly&quot;</code></pre>
<pre class="r"><code>options(contrasts = c(&quot;contr.helmert&quot;, &quot;contr.poly&quot;))
options(contrasts = c(&quot;contr.treatment&quot;, &quot;contr.poly&quot;))</code></pre>
</div>
</div>

<center>
<hr class="style1">
<p>Copyright &copy; 2020 Lindsey Thiessen and Brian J. Knaus. All rights reserved.</p>
</center>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
